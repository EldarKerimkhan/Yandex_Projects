# Финальный проект. Прогнозирование оттока клиентов оператора связи

## Задача
Построить модель для предсказания оттока клиентов оператора с метрикой AUC-ROC не меньше 0.85, по которой можно будет удержать клиента с помощью дополнительных предложений.

## Описание данных

Признаки

* BeginDate — дата начала пользования услугами,
* EndDate — дата окончания пользования услугами,
* Type — тип оплаты: ежемесячный, годовой и тд
* PaperlessBilling — безналичный расчет,
* PaymentMethod — способ оплаты,
* MonthlyCharges — ежемесячные траты на услуги,
* TotalCharges — всего потрачено денег на услуги
* Dependents — наличие иждивенцев
* SeniorCitizen — наличие пенсионного статуса по возрасту
* Partner — наличие супруга(и)
* MultipleLines — наличие возможности ведения параллельных линий во время звонка

Данные состоят из файлов, полученных из разных источников:

* contract_new.csv — информация о договоре;
* personal_new.csv — персональные данные клиента;
* internet_new.csv — информация об интернет-услугах;
* phone_new.csv — информация об услугах телефонии.

Во всех файлах столбец customerID содержит код клиента.

Информация о договорах актуальна на 1 февраля 2020.

## Используемые библиотеки
*pandas, numpy, os, matplotlib, seaborn, sklearn, phik, catboost*

## Выводы:

Была проведена предобработка данных:

Затем на этапе "Исследовательский анализ данных" выяснили, что наиболее прибыльный клиент для компании, который оплачивает услуги сразу на два года за безналичный расчет кредитной картой, имеет партнера и детей или пенсионеровов на иждивении, пользующийся интернетом через оптоволоконный кабель и оплачивающий доп. услуги.

Также выяснили, что в течение первого года компанию покидает около 7,5% клиентов. Чаще всего клиенты уходят в промежут пользования услугами от 500 до 1500 дней.

Для обучения были выбраны следующие признаки:
- 'type',
- 'paperless_billing',
- 'payment_method',
- 'monthly_charges',
- 'total_charges',
- 'days',
- 'senior_citizen',
- 'partner',
- 'dependents',
- 'internet_service',
- 'online_security',
- 'online_backup',
- 'device_protection',
- 'tech_support',
- 'streaming_t_v',
- 'streaming_movies',
- 'multiple_lines'.

На этапе "Обучение моделей"
* Разделили датасет на выборки, где обучащая выборка соотносится с тестовой как 4:1 (test_size=0.25).

  Размеры наборов данных:
 - Обучающая: 5274
 - Тестовая: 1758

Для моделей получены следующие результаты: 

| ML model | AUC-ROC_train | Accuracy_train|
| ---------------------- |:-----:| -----:|
| LogisticRegression     | 0.770 | 0.706 |
| RandomForestClassifier | 0.813 | 0.768 |
| CatBoostClassifier	   | 0.910 | 0.884 |

Параметры итоговой модели CatBoostClassifier, которые взяли для проверки на тестовом наборе данных: learning_rate= 0.6, iterations= 300, eval_metric= AUC, depth= 2, random_state=310723.

Результаты метрики на тестовом наборе данных получились AUC_ROC = 0.926, Accuracy = 0.889.

Отступлений от исходного плана работ не было. Все пункты выполнены в точном порядке.

Сложности были в определении признаков для обучения моделей (нехватка опыта скорее). Но данную трудность решил вебинар с тимлидом - почерпнул для себя новое, что из тех признаков, которые у тебя есть можно и нужно создать новые, которые, может быть, даже объединяют те, что есть в исходных данных.

Считаю, что все этапы проделанной работы важны в одинаковой степени. По сути, пока не проделал один этап, переходить к другому просто бессмысленно. И только, проделав все этапы, можно получить хорошую или хотя бы адекватную модель.
