# Восстановление золота из руды

## Задача
Построить модель, которая будет предсказывать коэффициент восстановления золота из золотосодержащей руды. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Описание данных
Данные находятся в трёх файлах:
* gold_industry_train.csv — обучающая выборка;
* gold_industry_test.csv — тестовая выборка;
* gold_industry_full.csv — исходные данные.

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

Технологический процесс

* Rougher feed — исходное сырье,
* Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
* Xanthate **— ксантогенат (промотер, или активатор флотации);
* Sulphate — сульфат (на данном производстве сульфид натрия);
* Depressant — депрессант (силикат натрия).
* Rougher process (англ. «грубый процесс») — флотация
* Rougher tails — отвальные хвосты
* Float banks — флотационная установка
* Cleaner process — очистка
* Rougher Au — черновой концентрат золота
* Final Au — финальный концентрат золота

## Используемые библиотеки
*pandas, numpy, matplotlib, seaborn, phik, optuna, sklearn, catboost*

## Выводы:
1. Провели подготовку данных:
2. Проверили корректность эффективности обогащения, представленной в датасетах.
3. Провели предобработку данных:
* Убрали лишние признаки из тренировочного датасета.
* Строки с пропусками в признаках заменили соседними.
* Столбец date привели к типу datetime.
4. Провели анализ данных:
* Выявили, что концентрация золота увеличивается от этапа к этапу.
* Выяснили, что датасет тестовый и обучающий распределены одинаково.
* Также очистили Датасет от отрицательных значений и явных выбросов.
5. Рассмотрели несколько моделей предсказания: Линейная регрессия, Дерево решений, Случайный лес.
Общая Цель проекта - минимизация метрики Итоговая sMAPE.
    
    - Для модели линейная регрессия Итоговая метрика sMAPE: -9.8. 
    - Для модели дерево решений Итоговая метрика sMAPE: -8.4.
    - Для модели случайный лес Итоговая метрика sMAPE: -7.8.
    - Для модели CatBoostRegressor Итоговая метрика sMAPE: -7.9. 
    
6. Проверили модель случайный лес на тестовой выборке и получили значение метрики Итоговый sMAPE: 6.4. 
